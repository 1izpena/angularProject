
<!-- estoy ya en body -->

<!-- si no hemos seleccionado canal se muestra otro panel (settings grupo) -->
<!--<div class="panel-body" id="panel-body1"> -->


<!-- no estaria mal saber cuantos estan new, cuantos in progress y cuantos closed dentro de cada sprint
-->
<div class="row row-all-content" ng-show="!item.viewinDetail && tagTask == -1" >
<div class="row row-backlog-chart">
    <div class="panel panel-info" id="panel-backlog-chart">


      <div class="panel-body panel-body-backlog-charts">

        <!-- max:: num de userstories totales
            current:: num userstories closed
            color, es el color del circulo current
            bdcolor:: el color de fondo -->


        <!-- cambiarlo xdatos reales -->


        <round-progress
          max=50
          current=20
          color="#69F0F0"
          bgcolor="#eaeaea"
          radius="50"
          stroke="10"
          semi="true"
          rounded="true"
          clockwise="false"
          responsive="false"
          duration="800"
          animation="easeInOutQuart"
          animation-delay="0">
          50/20
        </round-progress>



          <div class="summary-stats">
            <span class="percent">50%</span>
          </div>



          <div class="summary-stats">
            <p class="number">0</p>

            <p class="description">
              defined<br>
              points
            </p>


          </div>

          <div class="summary-stats">
            <p class="number">0</p>

            <p class="description">
              closed<br>
              points
            </p>


          </div>


          <div class="summary-stats">
            <p class="number">0</p>

            <p class="description">
              points /<br>
              sprint
            </p>


          </div>


          <div class="summary-stats">
            <!-- boton que muestra o no el grafico -->
            <a ng-show="rowCollectionUserStories.length > 0" class="btn btn-graphic" ng-click="changePercentClass()">
              <span class="fa fa-area-chart fa-3x"></span>
            </a>

          </div>





      </div>  <!-- end panel body -->
    </div>   <!-- end panel-info -->
  </div>     <!-- end row:: <div ng-if= "tagGroup !== '' " class="row" id="row-settings">
                              (Panel1: borrar, editar, unlink:: settings de grupo) -->








<div ng-show="showgraph.show && rowCollectionUserStories.length > 0"
     class="row row-backlog-charts-show-graph">
  <div class="panel panel-info" id="panel-backlog-graphs">


    <div class="panel-body panel-body-backlog-graphs">

      <!-- y aqui meteriamos la grafica -->
      <!-- hay que modificarla en base a los puntos que haya -->


      <!-- .chart-line
      chart-data: series data
      chart-labels: x axis labels
      chart-legend (default: false): show legend below the chart
      chart-options (default: {}): Chart.js options
      chart-series (default: []): series labels
      chart-click (optional): onclick event handler
      chart-hover (optional): onmousemove event handler
      chart-colours (default to global colours): colours for the chart -->




      <canvas id="line" class="chart chart-line" chart-data="chartdata"
              chart-labels="labels" chart-legend="false" chart-series="series"
              chart-click="onClickpoints" >
      </canvas>

    </div> <!-- end panel-body -->


  </div> <!-- end panel-info -->
</div> <!-- end row-settings1::<div ng-if= "tagGroup !== '' " class="row" id="row-settings1">
                              (Panel1: borrar, editar, unlink:: settings de grupo) -->






  <div class="row"
       ng-class="showgraph.show ? 'row-backlog-userstories-show-graph': 'row-backlog-userstories'">
    <div class="panel panel-info" id="panel-backlog-userstories">




      <!-- dejamos el panel anterior para que se cubra la pantalla -->

      <!-- si es false no hay niguno que tenga x sprint NONE,
      luego NO SE MOSTRARIA LA TABLA  -->
      <div class="panel-body panel-body-backlog-userstories"
           ng-show="rowCollectionUserStories.length == 0 || lookforUSWithSprint() == false">

        <div class="panel-backlog-empty">
          <div class="container">
          </div>
        </div>

        <div class="carousel-caption">



          <a class="btn btn-large btn-success" data-toggle="modal" data-target="#newUserStoryModal">
            <i class="fa fa-plus"></i>
            Add a new userstory
          </a>
        </div>


      </div>







      <!-- tod esto se muestra si hay userstories -->
      <!-- si es true,hay alguno que no tiene sprints asociados, asique se mostraria -->
      <div class="panel-body panel-body-backlog-userstories"
           ng-show="rowCollectionUserStories.length > 0 &&
           lookforUSWithSprint()">

      <!-- hay que meter container fluid para dividir nivel btn aniadir y la lista -->
        <!-- boton de aniadir userstory -->


        <div class="row row-backlog-userstories-new-btn">
          <div class="panel panel-info" id="panel-backlog-userstories-new-btn">
            <div class="panel-body panel-body-backlog-userstories-new-btn">


              <form>
                <div class="form-group">
                  <div class="input-group">


                    <span class="input-group-btn">
                        <button class="btn btn-primary" type="button">
                          <i class="fa fa-search"></i>
                        </button>
                    </span>

                    <span class="input-group-btn">
                      <oi-select
                        oi-options="item.name for item in comboOptions track by item.name"
                        ng-model="comboOptionsSelected" ng-change="clearValuesofSearchUS(comboOptionsSelected.num)">
                      </oi-select>
                    </span>


                    <input ng-show="comboOptionsSelected.num == 0" type="text" class="form-control searchUS" placeholder="Search by all fields" ng-model="searchUS.$"/>
                    <input ng-show="comboOptionsSelected.num == 1" type="text" class="form-control searchUS" placeholder="Search by subject" ng-model="searchUS.subject"/>

                    <input ng-show="comboOptionsSelected.num == 2" type="text" class="form-control searchUS" placeholder="Search by status" ng-model="searchUS.status"/>
                    <input ng-show="comboOptionsSelected.num == 3" type="text" class="form-control searchUS" placeholder="Search by tags" ng-model="searchTags"/>
                    <!--ng-model="searchUS.tags"-->


                    <!-- no hay seleccionados -->
                    <span ng-show="tableCells.selected.length == 0" class="input-group-btn">
                      <div class="input-group-btn">
                      <button class="btn btn-success" type="button" data-toggle="modal" data-target="#newUserStoryModal">
                        <i class="fa fa-plus"></i>
                        Add a new userstory
                      </button>
                        </div>
                    </span>


                    <!-- si hay varios seleccionados -->
                    <span ng-show="tableCells.selected.length > 0" class="input-group-btn">
                      <div class="input-group-btn">
                        <button class="btn btn-warning" type="button" data-toggle="modal" data-target="#selectSprintToUserStoryModal">
                          <i class="fa fa-exchange"></i>
                          Move to sprint
                        </button>

                        <button class="btn btn-danger" type="button" ng-click="removeUSs()">
                          <i class="fa fa-trash"></i>
                          Delete
                        </button>
                      </div>
                    </span>



                  </div>
                </div>
              </form>





              </div>
            </div>
          </div>





        <div class="row row-backlog-userstories-list">
          <div class="panel panel-info" id="panel-backlog-userstories-list">
            <div class="panel-body panel-body-backlog-userstories-list">


              <!-- esto es 1 tabla con status,points, userstory y votes  -->

              <!-- <th class="table-cell24">Subject</th>
                  <th class="table-cell1">Status</th>
                  <th class="table-cell06">Points</th>
                  <th class="table-cell1">Tags</th> --->


              <table class="table table-without-margin">
                <thead>
                <tr>


                  <th class="table-cell01">
                    <input type="checkbox" ng-click="checkAllNone(0)"
                           ng-checked="ischeckedAllCells">

                  </th>



                  <th class="table-cell05">
                    <a ng-click="sortType = 'voters'; sortReverse = !sortReverse">
                      Votes
                      <span ng-show="sortType == 'voters'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                    </a>

                  </th>
                  <th class="table-cell23">
                    <a ng-click="sortType = 'num'; sortReverse = !sortReverse">
                      User Stories
                      <span ng-show="sortType == 'num'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                      <span ng-show="tableCells.selected.length > 0"
                            class="badge badge-warning pull-right">{{tableCells.selected.length}}</span>

                    </a>

                  </th>
                  <th class="table-cell1">
                    <a ng-click="sortType = 'status'; sortReverse = !sortReverse">
                      Status
                      <span ng-show="sortType == 'status'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                    </a>

                  </th>
                  <th class="table-cell06">
                    <a ng-click="sortType = 'totalPoints'; sortReverse = !sortReverse">
                      Points
                      <span ng-show="sortType == 'totalPoints'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                    </a>

                  </th>
                  <th class="table-cell1">
                    <a ng-click="sortType = 'tags'; sortReverse = !sortReverse">
                      Tags
                      <span ng-show="sortType == 'tags'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                    </a>
                  </th>
                </tr>

                </thead>


                <tbody>

                <!--  | orderBy:sortType:sortReverse |filter:searchUS:strict"
                    ng-show="row.sprint == undefined "
                    ng-class="row.selectedCell ? 'cellSelectedClass' : ''"-->
                <tr ng-repeat="row in rowCollectionUserStories | orderBy:sortType:sortReverse | filter: (comboOptionsSelected.num == 3 ? {tags: searchTags} : searchUS)"
                    ng-hide="row.sprint !== undefined"
                    ng-class="row.selectedCell ? 'cellSelectedClass' : ''">




                  <td class="table-cell01">
                    <input type="checkbox" data-checklist-model="tableCells.selected" data-checklist-value="row" ng-click="changeCheckedTableCell(row)">

                    <!--cellSelectedClass -->

                  </td>


                  <td data-ng-click="viewDetailsUserstory(row)" class="table-cell05">{{row.voters.length}}</td>
                  <td data-ng-click="viewDetailsUserstory(row)" class="table-cell23">#{{row.num}} {{row.subject}}</td>
                  <td data-ng-click="viewDetailsUserstory(row)" class="table-cell1">{{row.status}}</td>
                  <td data-ng-click="viewDetailsUserstory(row)" class="table-cell06">{{row.totalPoints}}</td>
                  <td data-ng-click="viewDetailsUserstory(row)" class="table-cell1">
                    <span class="label label-info" ng-repeat="tag in row.tags ">{{tag}}</span><br ng-repeat="tag in row.tags">
                  </td>

                </tr>
                </tbody>


              </table>




            </div> <!-- end panel-body-backlog-userstories-list -->
          </div> <!-- end panel-backlog-userstories-list -->
        </div> <!-- end row-backlog-userstories-list -->




      </div> <!-- end panel-body-backlog-userstories -->

    </div> <!-- panel-info-->
  </div> <!-- end row--->

</div><!-- end row-all-content :: !item.viewinDetail && tagTask.num == undefined"-->





<!---------- new new new ---------------------------------------->



<!-- vista en detalle de userstory y sus relatedtasks -->
<div class="row row-all-content" ng-show="item.viewinDetail && tagTask == -1">
    <div class="panel panel-info" id="panel-detail-userstory">

      <!-- le hacemos flexbox y metemos colums -->
      <div class="panel-body panel-body-detail-userstory" id="panel-body-detail-userstory">

        <!-- esto sería la cabecera con votar, subject y puntos -->
        <!-- tmbn flex pero de rows -->

        <div class="summary-header-detail-userstory-parent">

          <div class="summary-header-detail-userstory">

            <div class="summary-detail-view">

              <span class="votes">{{tagUserstory.voters.length}}
              </span>
              <i ng-click="editVoteUserstory(0)" ng-show="!tagUserstoryTemp.disableVote" class="fa fa-plus"></i>
              <i ng-click="editVoteUserstory(1)" ng-show="tagUserstoryTemp.disableVote" class="fa fa-minus"></i>

            </div>

            <div class="summary-detail-view1">
              <span class="subject">#{{tagUserstory.num}}</span>

            </div>

            <div class="summary-detail-view2">
              <!--<span class="subject">Añadir un userstory con scrum en el canal con scrum diemdo tu llepa</span>-->
              <span class="subject" editable-text="tagUserstory.subject" e-required onbeforesave="editSubjectUserstory($data, tagUserstory)">
                                  {{ tagUserstory.subject || 'empty' }}
                                     </span>
            </div>

            <div class="summary-detail-view3">
              <span class="nextuserstory">
                <i class="fa fa-angle-right fa-lg"></i>
              </span>
            </div>

          </div><!-- end div summary-header-detail-userstory -->


          <div class="summary-detail-body1">
            <div class="created-by">
              <p> Created by
                <a ng-click=""> {{tagUserstory.createdby.username}}
                </a>
              </p>
              <p> {{tagUserstory.datetime | date:'medium'}}</p>
            </div>

            <div>
              <img
                ng-src="http://www.gravatar.com/avatar/{{getHash(tagUserstory.createdby.mail)}}?s=50&d=identicon"
                alt="User Avatar"
                class="avatar" id="img-circle"/>
            </div>

            <div class="view-task-detail-userstory">

              <button class="btn related-tasks" type="button" ng-click ="viewRelatedTasksUserstory()">
                <span ng-show="tagUserstory.tasks !== undefined &&
                                tagUserstory.tasks !== null && tagUserstory.tasks !== '' &&
                                tagUserstory.tasks.length > 0"
                      class="badge badge-warning pull-left">{{tagUserstory.tasks.length}}</span>

                Related tasks


                <span
                  ng-class="item.viewRelatedTasks ? 'glyphicon glyphicon glyphicon-chevron-up' :'glyphicon glyphicon glyphicon-chevron-down'"
                  aria-hidden="true">

                </span>



              </button>
            </div>


          </div>

        </div> <!-- end div summary-header-detail-userstory-parent -->







        <div class="summary-body-detail-userstory animate-show" ng-hide="item.viewRelatedTasks">
          <!-- aqui metemos los datos y ademas metemos tags-->
          <!-- aqui dentro hay que seguir haciendo columnas -->

          <div class="summary-detail-body2">
            <div class="form-group">

              <div class="btn-group btn-group-justified">
                <label>UX</label>
                <label>Design</label>
                <label>Back</label>
                <label>Front</label>
              </div>


              <div class="btn-group btn-group-justified">
                <button uib-popover-template="dynamicPopoverEdit.templateUrl" popover-placement="bottom"
                        type="button" class="btn btn-default"
                        popover="Popover 1">
                  {{tagUserstory.point.ux}}
                </button>

                <button uib-popover-template="dynamicPopoverDesEdit.templateUrl" popover-placement="bottom"
                        type="button" class="btn btn-default"
                        popover="Popover 2">
                  {{tagUserstory.point.design}}
                </button>

                <button uib-popover-template="dynamicPopoverFrontEdit.templateUrl" popover-placement="bottom"
                        type="button" class="btn btn-default"
                        popover="Popover 3">
                  {{tagUserstory.point.front}}
                </button>

                <button uib-popover-template="dynamicPopoverBackEdit.templateUrl" popover-placement="bottom"
                        type="button" class="btn btn-default"
                        popover="Popover 4">
                  {{tagUserstory.point.back}}
                </button>
              </div>




              <br>
              <label class="total-points">Total points: {{
                parseFloat(tagUserstory.point.ux) +
                parseFloat(tagUserstory.point.design) +
                parseFloat(tagUserstory.point.front) +
                parseFloat(tagUserstory.point.back) }}</label>


            </div> <!-- end form-group -->


          </div>

          <div class="summary-detail-body3">
            <div class="form-group">
              <label for="userstoryTag"> Tags: </label>
              <br>

              <tags-input ng-model="tagUserstoryTemp.tags" display-property="text"
                          placeholder="Tag me.."
                          replace-spaces-with-dashes="false"
                          on-tag-added="onAddedTag($tag)"
                          on-tag-removed="onRemovedTag($tag)">
              </tags-input>
            </div>
          </div>

          <div class="summary-detail-body4">
              <div class="form-group">
                <label for="userstoryDescr">Description:</label>
                <p editable-textarea="tagUserstory.description"
                   e-required
                   onbeforesave="editDescriptionUserstory($data, tagUserstory)">
                  {{ tagUserstory.description || 'Enter description to helps others better understand...' }}

                </p>
              </div>
          </div>


          <div class="summary-detail-body5">
            <div class="form-group requirements">

              <div class="btn-group">
                <label type='button' ng-click="editRequirementUserstory(0)" class="btn btn-default" ng-model="tagUserstory.requirement.team" uib-btn-checkbox>Team Requirement</label>
                <label type='button' ng-click="editRequirementUserstory(1)" class="btn btn-default" ng-model="tagUserstory.requirement.client" uib-btn-checkbox>Client Requirement</label>
                <label type='button' ng-click="editRequirementUserstory(2)" class="btn btn-warning" ng-model="tagUserstory.requirement.blocked" uib-btn-checkbox>Blocked</label>
              </div>

            </div>

          </div>



        </div> <!-- end view detail -->







        <!-- start view related tasks viewRelatedTasksUserstory-->

        <div class="summary-body-detail-userstory animate-show" ng-show="item.viewRelatedTasks && tagUserstory.tasks.length == 0">
          <!-- queremos 1 div de carrousel si no hay userstories -->

          <div class="panel-tasks-empty">
            <div class="container">
            </div>
          </div>

          <div class="carousel-caption">
            <a class="btn btn-large btn-success" data-toggle="modal" data-target="#newTaskModal">
              <i class="fa fa-plus"></i>
              Add a new task
            </a>
          </div>


        </div>
        <!-- sto se muestra si no hay tasks --------------------------------------->

        <!-- si hay tasks mostramos 1 tabla --------------------------------------->
        <div class="summary-body-detail-userstory animate-show" ng-show="item.viewRelatedTasks && tagUserstory.tasks.length > 0" >

          <!--<a class="btn btn-large btn-success" data-toggle="modal" data-target="#newTaskModal">
            <i class="fa fa-plus"></i>
            Add a new task
          </a>-->


          <div class="panel-body panel-body-backlog-tasks-new-btn">
            <form>
              <div class="form-group">
                <div class="input-group">


                      <span class="input-group-btn">
                          <button class="btn btn-primary" type="button">
                            <i class="fa fa-search"></i>
                          </button>
                      </span>

                      <span class="input-group-btn">
                        <oi-select
                          oi-options="item.name for item in comboOptionsTasks track by item.name"
                          ng-model="comboOptionsSelectedTask" ng-change="clearValuesofSearchTask(comboOptionsSelectedTask.num)">
                        </oi-select>
                      </span>


                  <input ng-show="comboOptionsSelectedTask.num == 0" type="text" class="form-control searchTask" placeholder="Search by all fields" ng-model="searchTask.$"/>
                  <input ng-show="comboOptionsSelectedTask.num == 1" type="text" class="form-control searchTask" placeholder="Search by subject" ng-model="searchTask.subject"/>

                  <input ng-show="comboOptionsSelectedTask.num == 2" type="text" class="form-control searchTask" placeholder="Search by status" ng-model="searchTask.status"/>
                  <input ng-show="comboOptionsSelectedTask.num == 3" type="text" class="form-control searchTask" placeholder="Search by members that assigned tasks" ng-model="searchTaskAssignedto"/>

                  <!-- ng-model="searchTask.assignedto" -->


                  <!-- no hay seleccionados -->
                      <span ng-show="tableCells.selected.length == 0" class="input-group-btn">
                        <div class="input-group-btn">
                          <button class="btn btn-success" type="button" data-toggle="modal" data-target="#newTaskModal">
                            <i class="fa fa-plus"></i>
                            Add a new task
                          </button>
                        </div>
                      </span>



                      <span ng-show="tableCells.selected.length > 0" class="input-group-btn">
                        <div class="input-group-btn">
                          <button class="btn btn-danger" type="button" ng-click="removeTasks()">
                            <i class="fa fa-trash"></i>
                            Delete
                          </button>

                        </div>
                      </span>





                </div>
              </div>
            </form>
          </div>


          <table class="table table-without-margin">
            <thead>
            <tr>


              <th class="table-cell01">
                <input type="checkbox" ng-click="checkAllNone(1)"
                       ng-checked="ischeckedAllCells">
              </th>

<!--
              <th class="table-cell05">
                <a href="" ng-click="sortType = 'voters'; sortReverse = !sortReverse">
                  Votes
                  <span ng-show="sortType == 'voters'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                </a>
              </th>
              -->


              <th class="table-cell4">
                <a ng-click="sortType = 'num'; sortReverse = !sortReverse">
                  Task
                  <span ng-show="sortType == 'num'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>


                  <span ng-show="tableCells.selected.length > 0"
                    class="badge badge-warning pull-left">{{tableCells.selected.length}}</span>
                </a>

              </th>
              <th class="table-cell15">
                <a ng-click="sortType = 'status'; sortReverse = !sortReverse">
                  Status
                  <span ng-show="sortType == 'status'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                </a>
              </th>

              <th class="table-cell14">
                <a ng-click="sortType = 'assignedto.username'; sortReverse = !sortReverse">
                  Assigned to
                  <span ng-show="sortType == 'assignedto.username'" class="fa" ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
                </a>
              </th>


            </tr>
            </thead>


            <tbody>


            <!--ng-show="row.sprint == undefined "
            searchTask.status
            searchTaskAssignedto


            filter: (comboOptionsSelected.num == 3 ? FilterFunction : searchUS)
            searchTask


            filter: (comboOptionsSelected.num == 3 ? {prueba : searchTaskAssignedto} : searchTask)
            -->
            <tr
                data-ng-repeat="row in tagUserstory.tasks | orderBy:sortType:sortReverse | filter:searchTask"
                ng-class="row.selectedCell ? 'cellSelectedClass' : ''"
                ng-hide="comboOptionsSelected.num == 3 && !FilterFunction(row)">


              <td class="table-cell01">
                <input type="checkbox" data-checklist-model="tableCells.selected" data-checklist-value="row" ng-click="changeCheckedTableCell(row)">
                <!--cellSelectedClass -->
              </td>



              <td data-ng-click="viewDetailsTask(row, $index)" class="table-cell4">#{{row.num}} {{row.subject}}</td>
              <td data-ng-click="viewDetailsTask(row,$index)" class="table-cell15">{{row.status}}</td>


              <!-- assignedto es 1 json -->

              <td ng-show="row.assignedto !== undefined && row.assignedto.id !== undefined" data-ng-click="changeTaskAssignedto(row)" class="table-cell14">
                <img
                  ng-src="http://www.gravatar.com/avatar/{{getHash(row.assignedto.mail)}}?s=50&d=identicon"
                  alt="User Avatar"
                  class="avatarin"/>
                <p>{{row.assignedto.username}}</p>
              </td>

              <td ng-show="row.assignedto == undefined || row.assignedto.id == undefined" data-ng-click="changeTaskAssignedto(row)" class="table-cell14">
                <img
                  ng-src="http://www.gravatar.com/avatar/{{getHash('internalUser@localhost')}}?s=50&d=identicon"
                  alt="User Avatar"
                  class="avatar"/>
                <p>{{row.assignedto.username || 'Not assigned'}}</p>

              </td>


            </tr>
            </tbody>


          </table>


        </div><!-- summaery-body-detail-uerstory:: tasks -->
        <!-- end view related tasks viewRelatedTasksUserstory -->



      </div>  <!-- end panel body:: flexbox con columns, que en realidad son filas -->
    </div>   <!-- end panel-info -->
 <!-- </div>     <!-- end row:: row-detail-subject -->









</div> <!--ng-show="item.viewinDetail" vista en detalle -->


<!-- vista en detalle de las tareas -->
<div class="row row-all-content" ng-show="item.viewinDetail && tagTask !== -1">
  <div class="panel panel-info" id="panel-detail-task">

    <!-- le hacemos flexbox y metemos colums -->
    <div class="panel-body panel-body-detail-task" id="panel-body-detail-task">
      <div class="summary-header-detail-task-parent">


        <div class="summary-header-detail-task">
          <!-- puedo poner los votos del userstory -->
          <div class="summary-detail-view">

              <span title="US votes" class="votes">{{tagUserstory.voters.length}}
              </span>
            <i ng-click="editVoteUserstory(0)" ng-show="!tagUserstoryTemp.disableVote" class="fa fa-plus"></i>
            <i ng-click="editVoteUserstory(1)" ng-show="tagUserstoryTemp.disableVote" class="fa fa-minus"></i>

          </div>

          <div class="summary-detail-view1">
            <span class="subject">#{{tagUserstory.tasks[tagTask].num}}</span>

          </div>

          <div class="summary-detail-view2">
              <span class="subject" editable-text="tagUserstory.tasks[tagTask].subject" e-required onbeforesave="editSubjectTask($data, tagUserstory.tasks[tagTask])">
                                  {{ tagUserstory.tasks[tagTask].subject || 'empty' }}
                                     </span>
          </div>

          <div class="summary-detail-view3">
              <span class="nexttask">
                <i class="fa fa-angle-right fa-lg"></i>
              </span>
          </div>

        </div><!-- end div summary-header-detail-userstory -->


        <div class="summary-detail-body1">
          <div class="created-by">
            <p> Created by
              <a ng-click=""> {{tagUserstory.tasks[tagTask].createdby.username}}
              </a>
            </p>
            <p> {{tagUserstory.tasks[tagTask].datetime | date:'medium'}}</p>
          </div>

          <div>
            <img
              ng-src="http://www.gravatar.com/avatar/{{getHash(tagUserstory.tasks[tagTask].createdby.mail)}}?s=50&d=identicon"
              alt="User Avatar"
              class="avatar" id="img-circle3"/>
          </div>


          <!-- boton para ver o no los comments y volver atras  -->
          <div class="view-comments-detail-task">
            <button class="btn related-comments" type="button">

              <span ng-click="goBackFromDetailTask()"
                aria-hidden="true">
                <i class="fa fa-reply-all" aria-hidden="true"></i>

              </span>

              Related comments

                <span
                  ng-click ="viewRelatedCommentsTask()"
                  ng-class="item.viewRelatedComments ? 'glyphicon glyphicon glyphicon-chevron-up' :'glyphicon glyphicon glyphicon-chevron-down'"
                  aria-hidden="true">

                </span>



            </button>




          </div>
        </div>

      </div> <!-- end div summary-header-detail-task-parent -->








      <!-- class to view tasks in detail -->
      <div class="summary-body-detail-task animate-show" ng-hide="item.viewRelatedComments" >

        <!--  para las tareas tenemos ::

    /* si locaine puede ser para varios, puedes poner contributors */
    assignedto      : { type: Schema.ObjectId, ref: 'User', required: false },
    contributors    : [{ type: Schema.ObjectId, ref: 'User', required: false }],

    /* new = 0, in progress = 1, readyfortest = 2, closed =3 */ -->


        <div class="summary-detail-task-body2"> <!-- column -->
          <div class="summary-detail-task-body2-child"> <!-- row -->

            <div class="summary-detail-task-body2-child-body1"> <!-- column -->

              <div class="form-group">
                <label>Status:</label>

                <oi-select oi-options="item for item in statics.status track by item"
                           ng-model="tagUserstory.tasks[tagTask].status"
                           ng-change="editStatusTask()"
                           required>

                </oi-select>
              </div> <!-- end form-group -->





              <div class="summary-detail-task-body21-child-body2" ng-show="tagUserstory.tasks[tagTask].assignedto !== undefined && tagUserstory.tasks[tagTask].assignedto.id !== undefined"> <!-- este es column -->

                <div>
                  <img
                    ng-src="http://www.gravatar.com/avatar/{{getHash(tagUserstory.tasks[tagTask].assignedto.mail)}}?s=50&d=identicon"
                    alt="User Avatar"
                    class="avatar" id="img-circle6"
                    ng-click="changeTaskAssignedto(tagUserstory.tasks[tagTask])"/>
                </div>

                <div class="summary-detail-task-body2-child-body2-assignedto">
                  <p> Assigned to </p>
                  <a> {{tagUserstory.tasks[tagTask].assignedto.username}}
                  </a>
                </div>
                <!--
                <div class="btn-group" role="group" aria-label="...">
                  <button title="add contributor" type="button" class="btn btn-default">
                    <span class="fa fa-user-plus"></span>
                  </button>
                </div>
                -->
                <span>
                  <i ng-click="unassignedTask(tagUserstory.tasks[tagTask])" class="fa fa-times" aria-hidden="true"></i>
                </span>



              </div>


              <!-- lo mismo para NOT ASSIGNED -->
              <div class="summary-detail-task-body21-child-body2" ng-show="tagUserstory.tasks[tagTask].assignedto == undefined || tagUserstory.tasks[tagTask].assignedto.id == undefined"> <!-- este es column -->

                <div>
                  <img
                    ng-src="http://www.gravatar.com/avatar/{{getHash('internalUser@localhost')}}?s=50&d=identicon"
                    alt="User Avatar"
                    class="avatar" id="img-circle7"
                    ng-click="changeTaskAssignedto(tagUserstory.tasks[tagTask])"/>
                </div>

                <div class="summary-detail-task-body2-child-body2-assignedto">
                  <p> Assigned to </p>
                  <a ng-click=""> Not assigned
                  </a>
                </div>

              </div>



            </div>






            <!-- aqui irian los contributors si hay -->
               <!-- <span aria-hidden="true">&times;</span> -->


              <div class="form-contributors">

                <div class="form-contributors-btn">

                    <button title="new contributor"
                            ng-click="addContributorTask( contributor)"
                            type="button" class="btn btn-info">
                      <span class="fa fa-user-plus"></span>
                    </button>
                    <button type="button" class="btn btn-info btn-label-contributor">
                      Contributors
                    </button>

                </div>



                <div class="contributors-list">
                  <ul class="media-list list-group" ng-show="tagUserstory.tasks[tagTask].contributors !== undefined || tagUserstory.tasks[tagTask].contributors.length > 0">

                    <li class="media list-group-item" ng-repeat="contributor in tagUserstory.tasks[tagTask].contributors">

                      <div class="comment">
                        <img
                          ng-src="http://www.gravatar.com/avatar/{{getHash(contributor.mail)}}?s=50&d=identicon"
                          alt="User Avatar"
                          class="avatar-comments"/>


                        <div class="media-body">
                          <strong class="username">{{contributor.username}} </strong>
                          <span>
                            <i ng-click="removeContributorTask(contributor)" class="fa fa-times" aria-hidden="true"></i>
                          </span>
                        </div>

                        <div class="clearfix"></div>

                      </div> <!-- end div comments -->
                    </li>

                  </ul>
                </div>


            </div> <!--end contributors:: derecha -->




          </div> <!-- end hacemos columnas:: row -->

        </div> <!-- end hacemos filas:: columns -->






        <!-- description -->
        <div class="summary-detail-body4">
          <div class="form-group">
            <label for="taskDescr">Description:</label>
            <p editable-textarea="tagUserstory.tasks[tagTask].description"
               e-required
               onbeforesave="editDescriptionTask($data, tagUserstory.tasks[tagTask])">
              {{ tagUserstory.tasks[tagTask].description || 'Enter description to helps others better understand...' }}

            </p>
          </div>
        </div>


        <div class="summary-detail-body5">
          <div class="form-group requirements-task">
            <!-- solo requirement -->

            <div class="btn-group">
                <label type='button' ng-click="editRequirementTask(0)" class="btn btn-warning" ng-model="tagUserstory.tasks[tagTask].requirement.blocked" uib-btn-checkbox>Blocked</label>
                <label type='button' ng-click="editRequirementTask(1)" class="btn btn-info" ng-model="tagUserstory.tasks[tagTask].requirement.iocaine" uib-btn-checkbox>Power</label>

            </div>


          </div>
        </div>



      </div> <!-- end view detail -->






      <!-- aqui ponemos los comments -->
      <div class="summary-body-detail-task-comments animate-show" ng-show="item.viewRelatedComments" >






        <div class="well well-custom" scroll-bottom-on-last="tagUserstory.tasks[tagTask].comments">
          <ul class="media-list list-group">



            <!-- elfalso -->
            <li class="media list-group-item"
                ng-show="tagUserstory.tasks[tagTask].comments == undefined || tagUserstory.tasks[tagTask].comments.length == 0">
              <div class="comment">

                <img
                  ng-src="http://www.gravatar.com/avatar/{{getHash('internalUser@localhost')}}?s=50&d=identicon"
                  alt="User Avatar"
                  class="avatar-comments"/>


                <div class="media-body">

                  <strong class="username">MeanStack </strong>
                  <small class="date date-comments" >
                    <span class="glyphicon glyphicon-time"></span>

                    <span>Right now</span>
                  </small>

                  <p> Empty space is so boring ... </p>

                </div>
                <div class="clearfix"></div>

              </div>
            </li>



            <!-- --------------- el real ------------------ -->
            <li class="media list-group-item"
                ng-repeat="comment in tagUserstory.tasks[tagTask].comments" send-last
                ng-show="tagUserstory.tasks[tagTask].comments !== undefined && tagUserstory.tasks[tagTask].comments.length > 0"
                name="{{comment.id}}" id="{{comment.id}}">

              <div class="comment">



                  <img
                    ng-src="http://www.gravatar.com/avatar/{{getHash(comment.user.mail)}}?s=50&d=identicon"
                    alt="User Avatar"
                    class="avatar-comments"/>


                <div class="media-body">

                  <strong class="username">{{comment.user.username}}</strong>
                  <small class="date date-comments" >
                    <span class="glyphicon glyphicon-time"></span>
                    <span am-time-ago="comment.created"></span>

                  </small>


                  <p>    {{comment.comment}}    </p>
                  <small class="date date-comments" ng-show="comment.isEditable" ng-click="removeComment(comment)">
                    <span class="glyphicon glyphicon-trash"></span>
                  </small>

                </div>
                <div class="clearfix"></div>
              </div>

            </li>


          </ul>

        <!-- 2 ul's para well class:: comments -->


        </div>

        <!-- end divs con 2 ul's para well class:: comments -->



        <!--<div class="well">-->
          <div class="panel-body comments">
            <textarea class="form-control" placeholder="Type your comment"
                      rows="2" id="commentText"
                      ng-model="item.commentText">
            </textarea>
            <button type="button" class="btn btn-info pull-right" ng-click="sendCommentText()">
              Submit comment
            </button>
          </div>
         <!-- </div>-->








        </div>
















        <!----------------final del lo nuevo copiado -------------->









    </div><!-- detail tasks -->

  </div> <!--panel-detail-task end detail-task -->









</div> <!-- end vista en detalle de las tareas -->














<!--
</div> <!--  panel-body1 (( ng-if= "tagChannel == '' "))-->




<!--- ********** MODALS ************ -->


<!-- ---- New Related Task Modal ---- -->
<div id="newTaskModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->

    <div class="modal-content">
      <div class="modal-header" >

        <!-- hay que cambiar el initVarsNewUserstoryModal() -->

        <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                ng-click="initVarsNewRelatedTaskModal()">
          <span aria-hidden="true">&times;</span>
        </button>

        <h4 class="modal-title">New Task</h4>
      </div>

      <div class="modal-body" >


        <div class="alert alert-danger" role="alert" ng-if="modalsError.messageNewRelatedTaskModal !== ''">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="modalsError.messageNewRelatedTaskModal =''">
            <span aria-hidden="true">&times;</span>
          </button>
          {{modalsError.messageNewRelatedTaskModal}}

        </div>






        <!-- subject -->
        <div class="form-group">
          <label for="taskSubject">Subject:</label>
          <input type="text" class="form-control" name="taskSubjectTxt"
                 id="taskSubject" placeholder="Enter Task Subject..."
                 ng-model="task.subject">

          <div class="alert alert-danger" role="alert" ng-if="modalsError.messageNewRelatedTaskRequiredSubModal !== ''">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="modalsError.messageNewRelatedTaskRequiredSubModal =''">
              <span aria-hidden="true">&times;</span>
            </button>
            <!-- cambiar esto diciendo que necesita que elcampo este completo -->
            {{modalsError.messageNewRelatedTaskRequiredSubModal}}

          </div>

        </div>



        <!-- status
        luego poner
        ng-show="tagUserstory.sprint !== null && !== undefined && !== ''"
        -->
        <div class="form-group">
        <oi-select oi-options="item for item in statics.status track by item"
          ng-model="task.status"
          required></oi-select>
        </div>



        <!-- descripcion -->
        <div class="form-group">
          <label for="taskDescr">Description:</label>
          <textarea class="form-control" id="taskDescr"
                    placeholder="Enter description to helps others better understand..."
                    ng-model="task.description">
          </textarea>
        </div>




        <div class="form-group requirements-task">
          <div class="btn-group">
            <label type='button' class="btn btn-warning" ng-model="task.requirement.blocked" uib-btn-checkbox>Blocked</label>
            <label type='button' class="btn btn-info" ng-model="task.requirement.iocaine" uib-btn-checkbox>Power</label>

          </div>

        </div>






      </div> <!-- end modal body -->



      <div class="modal-footer">
        <button type="submit" class="btn btn-success" id="btn-new-related-task" ng-click="createNewRelatedTask()"><span class="fa fa-floppy-o">
        </span> Create</button>

        <!-- inicializar variables -->
        <button type="button" class="btn btn-danger" id="btn-new-related-task-close" data-dismiss="modal" ng-click="initVarsNewRelatedTaskModal()">
          <span class="fa fa-remove"></span> Close</button>

      </div>
    </div>
  </div>
</div>



<!--------------------------------- select sprint to US modal------------------------------------------------>
<!-- hacemos 1 lista de sprints : # num name :start date end date ------------->

<div id="selectSprintToUserStoryModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->

    <div class="modal-content">
      <div class="modal-header" >

        <!-- hay que cambiar el initVarsNewUserstoryModal() -->

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>

        <h4 class="modal-title">Move to Sprint</h4>
      </div>

      <div class="modal-body" >


        <!-- puede que no haya sprints creados , en esecaso lo dices -->
        <div class="alert alert-danger" role="alert"
             ng-show="rowCollectionSprints == undefined ||
             rowCollectionSprints == null ||
             rowCollectionSprints == '' ||
             rowCollectionSprints.length < 0 ">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close" >
            <span aria-hidden="true">&times;</span>
          </button>
          Not sprints yet, create a new sprint...

        </div>



        <table class="table table-hover">
          <thead>

          <tr>

            <th class="table-cell23">
              <a ng-click="sortType = 'num'; sortReverse = !sortReverse">
                Sprints
                      <span ng-show="sortType == 'num'" class="fa"
                            ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
              </a>
            </th>

            <th class="table-cell23">
              <a ng-click="sortType = 'startdate'; sortReverse = !sortReverse">
                Start date
                      <span ng-show="sortType == 'startdate'" class="fa"
                            ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
              </a>
            </th>

            <th class="table-cell23">
              <a ng-click="sortType = 'enddate'; sortReverse = !sortReverse">
                Ending date
                      <span ng-show="sortType == 'enddate'" class="fa"
                            ng-class="sortReverse ? 'fa-caret-up' : 'fa-caret-down'"></span>
              </a>
            </th>

          </thead>




          <tbody>
          <tr ng-repeat="row in rowCollectionSprints | orderBy:sortType:sortReverse">
            <!-- row -->
            <td data-ng-click="editSprintUserstory(row)" class="table-cell23">#{{row.num}} {{row.name}}</td>
            <td data-ng-click="editSprintUserstory(row)" class="table-cell23">{{row.startdate | amDateFormat:'ddd, MMM D, YYYY'}} </td>
            <td data-ng-click="editSprintUserstory(row)" class="table-cell23">{{row.enddate | amDateFormat:'ddd, MMM D, YYYY'}}</td>

          </tr>
          </tbody>


        </table>


      </div> <!-- end modal body -->


      <div class="modal-footer">

        <button type="button" class="btn btn-danger" id="btn-closed-choose-sprint" data-dismiss="modal">
          <span class="fa fa-remove"></span> Close</button>

      </div>
    </div>
  </div>
</div>























<!-- New User Story Modal (meter integracion SCRUM -->
<div id="newUserStoryModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->

    <div class="modal-content">
      <div class="modal-header" >


        <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                ng-click="initVarsNewUserstoryModal()">
          <span aria-hidden="true">&times;</span>
        </button>

        <h4 class="modal-title">New User Story</h4>
      </div>

      <div class="modal-body" >


        <div class="alert alert-danger" role="alert" ng-show="modalsError.messageNewUserstoryModal !== ''">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="modalsError.messageNewUserstoryModal =''">
            <span aria-hidden="true">&times;</span>
          </button>
          {{modalsError.messageNewUserstoryModal}}

        </div>






        <!-- subject -->
        <div class="form-group">
          <label for="userstorySubject">Subject:</label>
          <input type="text" class="form-control" name="userstorySubjectTxt"
                 id="userstorySubject" placeholder="Enter Userstory Subject..."
                 ng-model="userstory.subject">

          <div class="alert alert-danger" role="alert" ng-show="modalsError.messageNewUserstoryRequiredSubModal !== ''">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="modalsError.messageNewUserstoryRequiredSubModal =''">
              <span aria-hidden="true">&times;</span>
            </button>
            {{modalsError.messageNewUserstoryRequiredSubModal}}

          </div>

        </div>



        <!-- points -->
        <div class="form-group">

          <div class="btn-group btn-group-justified">
            <label>UX</label>
            <label>Design</label>
            <label>Back</label>
            <label>Front</label>
          </div>



          <div class="btn-group btn-group-justified">

            <button uib-popover-template="dynamicPopover.templateUrl" popover-placement="bottom"
                    type="button" class="btn btn-default" id="userstoryUX"
                    popover="Popover 1">
              {{userstory.point.ux}}
            </button>

            <button uib-popover-template="dynamicPopoverDes.templateUrl" popover-placement="bottom"
                    type="button" class="btn btn-default" id="userstoryDes"
                    popover="Popover 2">
              {{userstory.point.design}}
            </button>

            <button uib-popover-template="dynamicPopoverFront.templateUrl" popover-placement="bottom"
                    type="button" class="btn btn-default" id="userstoryFront"
                    popover="Popover 3">
              {{userstory.point.front}}
            </button>

            <button uib-popover-template="dynamicPopoverBack.templateUrl" popover-placement="bottom"
                    type="button" class="btn btn-default" id="userstoryBack"
                    popover="Popover 4">
              {{userstory.point.back}}
            </button>

          </div>




            <br>
            <label class="total-points">Total points: {{
              parseFloat(userstory.point.ux) +
              parseFloat(userstory.point.design) +
              parseFloat(userstory.point.front) +
              parseFloat(userstory.point.back) }}</label>


          </div> <!-- end form-group -->




          <!-- tags (separar con tabulador) -->
        <div class="form-group">
          <label for="userstoryTag"> Tags: </label>
          <br>

          <tags-input ng-model="userstory.tags" display-property="text"
                      placeholder="Tag me.."
                      replace-spaces-with-dashes="false"
                      id="userstoryTag">
          </tags-input>
        </div>



        <!-- descripcion -->
        <div class="form-group">
          <label for="userstoryDescr">Description:</label>
          <textarea class="form-control" id="userstoryDescr"
                 placeholder="Enter description to helps others better understand..."
                 ng-model="userstory.description">
          </textarea>
        </div>


        <!-- requirement:: checkbox type requirement-->
        <div class="form-group requirements">

          <div class="btn-group">
            <label class="btn btn-default" ng-model="userstory.requirement.team" uib-btn-checkbox>Team Requirement</label>
            <label class="btn btn-default" ng-model="userstory.requirement.client" uib-btn-checkbox>Client Requirement</label>
            <label class="btn btn-warning" ng-model="userstory.requirement.blocked" uib-btn-checkbox>Blocked</label>
          </div>

        </div>



        <!-- falta votes ?-->

      </div> <!-- end modal body -->



      <div class="modal-footer">
        <button type="submit" class="btn btn-success" id="btn-new-userstory" ng-click="createNewUserstory()"><span class="fa fa-floppy-o">
        </span> Create</button>

        <!-- inicializar variables -->
        <button type="button" class="btn btn-danger" id="btn-new-userstory-close" data-dismiss="modal" ng-click="initVarsNewUserstoryModal()">
          <span class="fa fa-remove"></span> Close</button>

      </div>
    </div>
  </div>
</div>


